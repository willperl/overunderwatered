---
title: 1. Single file
layout: page
---

<input id="photo" type="file">
<div id="results"></div>

<script>
  async function loaded(reader) {
    const dataUrl = reader.result;

    const response = await fetch('https://smittens-overorunderwatered.hf.space/api/predict/', {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ data: [dataUrl] })  // Must be base64 string!
    });

    const json = await response.json();

    // Check if data is returned
    if (!json.data) {
      console.error("json.data missing: ", json);
      results.innerHTML = `<p>API returned unexpected response</p>`;
      return;
    }

    const label = json.data[0].label || json.data[0].confidences?.[0]?.label;
    const conf = json.data[0].confidences?.[0]?.confidence;

    results.innerHTML = `<br/><img src="${dataUrl}" width="300"> <p>${label}</p> <p>${conf}<p>`;
  }

  function read() {
    const reader = new FileReader();
    reader.onload = () => loaded(reader);  // Use onload, not addEventListener
    reader.readAsDataURL(document.getElementById("photo").files[0]);  // Read as base64
  }

  document.getElementById("photo").addEventListener("input", read);
</script>